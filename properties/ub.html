<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>body {background-color: #b0b0b0;}</style>
    <title>UB Properties</title>
  </head>

  <script src="../header.js"></script>

  <body style="font-family:arial;" align="center">
    <h3 align="Center">UB Properties</h3>
    <p>Search, sort or hover over a member to see its properties.</p>
    <div class="inputBox" align="middle">
      <input type="text" id="myInput" onkeyup="searchFunction()" placeholder="Search for a member" title="Type in a member">
    </div>

    <button class="button" onclick="sortSizeDown(10)">Decreasing Size</button>
    <button class="button" onclick="sortSizeUp(10)">Increasing Size</button>
    <button class="button" onclick="sortMassDown(1)">Decreasing Mass</button>
    <button class="button" onclick="sortMassUp(1)">Increasing Mass</button>
    <br>
    <br>

    <table id="myTable" align="center">
      <colgroup>
        <col span="1" width="85">
        <col span="1" width="45">
        <col span="1" width="50">
        <col span="1" width="57">
        <col span="1" width="84">
        <col span="1" width="84">
        <col span="1" width="72">
        <col span="1" width="72">
        <col span="1" width="60">
        <col span="1" width="55">
        <col span="1" width="10">
      </colgroup>

      <tr>
        <th rowspan="3">Member</th>
        <th rowspan="2">Mass</th>
        <th colspan="6">Dimensions</th>
        <th>Ixx</th>
        <th>Gross Area</th>
        <th rowspan="3" class='rotateOrder'><div>Order</div></th>
      </tr>
      <tr>
        <th>Depth</th>
        <th>Flange Width</th>
        <th>Flange Thickness</th>
        <th>Web Thickness</th>
        <th>Root Radius</th>
        <th>Depth Between Flanges</th>
        <th>Ixx</th>
        <th>A<sub>g</sub></th>
      </tr>
      <tr>
        <th>kg/m</th>
        <th>mm</th>
        <th>mm</th>
        <th>mm</th>
        <th>mm</th>
        <th>mm</th>
        <th>mm</th>
        <th>mm<sup>4</sup></th>
        <th>mm<sup>2</sup></th>
      </tr>
      <tbody id="ubTableBody">
        <tr>
          <td colspan="11">Loading UB data...</td>
        </tr>
      </tbody>
    </table>

    <br>
    <br>
  </body>
</html>
<script src="../tables.js"></script>
<script>
  function parseSimpleCsv(text) {
  var lines = text.split(/\r?\n/).filter(function(line) {
  return line.trim() !== "";
  });
  if (lines.length < 2) return [];

  var headers = lines[0].split(",").map(function(h) {
  return h.trim();
  });

  var data = [];
  for (var i = 1; i < lines.length; i++) {
  var values = lines[i].split(",");
  if (values.length !== headers.length) continue;

  var row = {};
  for (var j = 0; j < headers.length; j++) {
  row[headers[j]] = values[j].trim();
  }
  data.push(row);
  }

  return data;
  }

  function formatRatio(depth, flangeWidth) {
  var d = Number(depth);
  var b = Number(flangeWidth);
  if (!b) return "";
  return (d / b).toFixed(2);
  }

  function addCell(row, value) {
  var cell = document.createElement("td");
  cell.innerText = value;
  row.appendChild(cell);
  }

  function renderUbRows(rows) {
  var body = document.getElementById("ubTableBody");
  body.innerHTML = "";

  if (!rows.length) {
  var emptyRow = document.createElement("tr");
  addCell(emptyRow, "No UB data found.");
  emptyRow.firstChild.colSpan = 11;
  body.appendChild(emptyRow);
  return;
  }

  for (var i = 0; i < rows.length; i++) {
  var r = rows[i];
  var tr = document.createElement("tr");
  tr.setAttribute("onclick", "changeColour(this)");

  addCell(tr, r.Member);
  addCell(tr, r.Mass);
  addCell(tr, r.Depth);
  addCell(tr, r.FlangeWidth);
  addCell(tr, r.FlangeThickness);
  addCell(tr, r.WebThickness);
  addCell(tr, r.RootRadius);
  addCell(tr, r.DepthBetweenFlanges);
  addCell(tr, r.Ixx || "");
  addCell(tr, r.GrossArea);
  addCell(tr, r.Order);

  body.appendChild(tr);
  }
  }

  (function loadUbCsv() {
  fetch("./ub.csv", { cache: "no-store" })
  .then(function(response) {
  if (!response.ok) {
  throw new Error("Failed to load ub.csv");
  }
  return response.text();
  })
  .then(function(text) {
  renderUbRows(parseSimpleCsv(text));
  })
  .catch(function() {
  var body = document.getElementById("ubTableBody");
  body.innerHTML = '<tr><td colspan="11">Could not load UB CSV data.</td></tr>';
  });
  })();
</script>


